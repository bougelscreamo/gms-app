import{H as V,J as C,c as T,a as r,x as U,i as v,P as y,v as L,b as W,j as R,o as I}from"./entry.69edd33e.js";import{u as P}from"./data.8bfc3874.js";import"./sweetalert2.all.7ef268f0.js";/*!
 * Signature Pad v3.0.0-beta.4 | https://github.com/szimek/signature_pad
 * (c) 2020 Szymon Nowak | Released under the MIT license
 */class w{constructor(t,e,s){this.x=t,this.y=e,this.time=s||Date.now()}distanceTo(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}equals(t){return this.x===t.x&&this.y===t.y&&this.time===t.time}velocityFrom(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):0}}class S{constructor(t,e,s,i,o,h){this.startPoint=t,this.control2=e,this.control1=s,this.endPoint=i,this.startWidth=o,this.endWidth=h}static fromPoints(t,e){const s=this.calculateControlPoints(t[0],t[1],t[2]).c2,i=this.calculateControlPoints(t[1],t[2],t[3]).c1;return new S(t[1],s,i,t[2],e.start,e.end)}static calculateControlPoints(t,e,s){const i=t.x-e.x,o=t.y-e.y,h=e.x-s.x,a=e.y-s.y,c={x:(t.x+e.x)/2,y:(t.y+e.y)/2},d={x:(e.x+s.x)/2,y:(e.y+s.y)/2},l=Math.sqrt(i*i+o*o),g=Math.sqrt(h*h+a*a),_=c.x-d.x,f=c.y-d.y,u=g/(l+g),m={x:d.x+_*u,y:d.y+f*u},p=e.x-m.x,E=e.y-m.y;return{c1:new w(c.x+p,c.y+E),c2:new w(d.x+p,d.y+E)}}length(){let e=0,s,i;for(let o=0;o<=10;o+=1){const h=o/10,a=this.point(h,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),c=this.point(h,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(o>0){const d=a-s,l=c-i;e+=Math.sqrt(d*d+l*l)}s=a,i=c}return e}point(t,e,s,i,o){return e*(1-t)*(1-t)*(1-t)+3*s*(1-t)*(1-t)*t+3*i*(1-t)*t*t+o*t*t*t}}function z(n,t=250){let e=0,s=null,i,o,h;const a=()=>{e=Date.now(),s=null,i=n.apply(o,h),s||(o=null,h=[])};return function(...d){const l=Date.now(),g=t-(l-e);return o=this,h=d,g<=0||g>t?(s&&(clearTimeout(s),s=null),e=l,i=n.apply(o,h),s||(o=null,h=[])):s||(s=window.setTimeout(a,g)),i}}class x{constructor(t,e={}){this.canvas=t,this.options=e,this._handleMouseDown=s=>{s.which===1&&(this._mouseButtonDown=!0,this._strokeBegin(s))},this._handleMouseMove=s=>{this._mouseButtonDown&&this._strokeMoveUpdate(s)},this._handleMouseUp=s=>{s.which===1&&this._mouseButtonDown&&(this._mouseButtonDown=!1,this._strokeEnd(s))},this._handleTouchStart=s=>{if(s.preventDefault(),s.targetTouches.length===1){const i=s.changedTouches[0];this._strokeBegin(i)}},this._handleTouchMove=s=>{s.preventDefault();const i=s.targetTouches[0];this._strokeMoveUpdate(i)},this._handleTouchEnd=s=>{if(s.target===this.canvas){s.preventDefault();const o=s.changedTouches[0];this._strokeEnd(o)}},this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle="throttle"in e?e.throttle:16,this.minDistance="minDistance"in e?e.minDistance:5,this.dotSize=e.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.onBegin=e.onBegin,this.onEnd=e.onEnd,this._strokeMoveUpdate=this.throttle?z(x.prototype._strokeUpdate,this.throttle):x.prototype._strokeUpdate,this._ctx=t.getContext("2d"),this.clear(),this.on()}clear(){const{_ctx:t,canvas:e}=this;t.fillStyle=this.backgroundColor,t.clearRect(0,0,e.width,e.height),t.fillRect(0,0,e.width,e.height),this._data=[],this._reset(),this._isEmpty=!0}fromDataURL(t,e={},s){const i=new Image,o=e.ratio||window.devicePixelRatio||1,h=e.width||this.canvas.width/o,a=e.height||this.canvas.height/o;this._reset(),i.onload=()=>{this._ctx.drawImage(i,0,0,h,a),s&&s()},i.onerror=c=>{s&&s(c)},i.src=t,this._isEmpty=!1}toDataURL(t="image/png",e){switch(t){case"image/svg+xml":return this._toSVG();default:return this.canvas.toDataURL(t,e)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",window.PointerEvent?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.removeEventListener("pointerdown",this._handleMouseDown),this.canvas.removeEventListener("pointermove",this._handleMouseMove),document.removeEventListener("pointerup",this._handleMouseUp),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(t){this.clear(),this._fromData(t,({color:e,curve:s})=>this._drawCurve({color:e,curve:s}),({color:e,point:s})=>this._drawDot({color:e,point:s})),this._data=t}toData(){return this._data}_strokeBegin(t){const e={color:this.penColor,points:[]};typeof this.onBegin=="function"&&this.onBegin(t),this._data.push(e),this._reset(),this._strokeUpdate(t)}_strokeUpdate(t){if(this._data.length===0){this._strokeBegin(t);return}const e=t.clientX,s=t.clientY,i=this._createPoint(e,s),o=this._data[this._data.length-1],h=o.points,a=h.length>0&&h[h.length-1],c=a?i.distanceTo(a)<=this.minDistance:!1,d=o.color;if(!a||!(a&&c)){const l=this._addPoint(i);a?l&&this._drawCurve({color:d,curve:l}):this._drawDot({color:d,point:i}),h.push({time:i.time,x:i.x,y:i.y})}}_strokeEnd(t){this._strokeUpdate(t),typeof this.onEnd=="function"&&this.onEnd(t)}_handlePointerEvents(){this._mouseButtonDown=!1,this.canvas.addEventListener("pointerdown",this._handleMouseDown),this.canvas.addEventListener("pointermove",this._handleMouseMove),document.addEventListener("pointerup",this._handleMouseUp)}_handleMouseEvents(){this._mouseButtonDown=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)}_reset(){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor}_createPoint(t,e){const s=this.canvas.getBoundingClientRect();return new w(t-s.left,e-s.top,new Date().getTime())}_addPoint(t){const{_lastPoints:e}=this;if(e.push(t),e.length>2){e.length===3&&e.unshift(e[0]);const s=this._calculateCurveWidths(e[1],e[2]),i=S.fromPoints(e,s);return e.shift(),i}return null}_calculateCurveWidths(t,e){const s=this.velocityFilterWeight*e.velocityFrom(t)+(1-this.velocityFilterWeight)*this._lastVelocity,i=this._strokeWidth(s),o={end:i,start:this._lastWidth};return this._lastVelocity=s,this._lastWidth=i,o}_strokeWidth(t){return Math.max(this.maxWidth/(t+1),this.minWidth)}_drawCurveSegment(t,e,s){const i=this._ctx;i.moveTo(t,e),i.arc(t,e,s,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve({color:t,curve:e}){const s=this._ctx,i=e.endWidth-e.startWidth,o=Math.floor(e.length())*2;s.beginPath(),s.fillStyle=t;for(let h=0;h<o;h+=1){const a=h/o,c=a*a,d=c*a,l=1-a,g=l*l,_=g*l;let f=_*e.startPoint.x;f+=3*g*a*e.control1.x,f+=3*l*c*e.control2.x,f+=d*e.endPoint.x;let u=_*e.startPoint.y;u+=3*g*a*e.control1.y,u+=3*l*c*e.control2.y,u+=d*e.endPoint.y;const m=Math.min(e.startWidth+d*i,this.maxWidth);this._drawCurveSegment(f,u,m)}s.closePath(),s.fill()}_drawDot({color:t,point:e}){const s=this._ctx,i=typeof this.dotSize=="function"?this.dotSize():this.dotSize;s.beginPath(),this._drawCurveSegment(e.x,e.y,i),s.closePath(),s.fillStyle=t,s.fill()}_fromData(t,e,s){for(const i of t){const{color:o,points:h}=i;if(h.length>1)for(let a=0;a<h.length;a+=1){const c=h[a],d=new w(c.x,c.y,c.time);this.penColor=o,a===0&&this._reset();const l=this._addPoint(d);l&&e({color:o,curve:l})}else this._reset(),s({color:o,point:h[0]})}}_toSVG(){const t=this._data,e=Math.max(window.devicePixelRatio||1,1),s=0,i=0,o=this.canvas.width/e,h=this.canvas.height/e,a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("width",this.canvas.width.toString()),a.setAttribute("height",this.canvas.height.toString()),this._fromData(t,({color:f,curve:u})=>{const m=document.createElement("path");if(!isNaN(u.control1.x)&&!isNaN(u.control1.y)&&!isNaN(u.control2.x)&&!isNaN(u.control2.y)){const p=`M ${u.startPoint.x.toFixed(3)},${u.startPoint.y.toFixed(3)} C ${u.control1.x.toFixed(3)},${u.control1.y.toFixed(3)} ${u.control2.x.toFixed(3)},${u.control2.y.toFixed(3)} ${u.endPoint.x.toFixed(3)},${u.endPoint.y.toFixed(3)}`;m.setAttribute("d",p),m.setAttribute("stroke-width",(u.endWidth*2.25).toFixed(3)),m.setAttribute("stroke",f),m.setAttribute("fill","none"),m.setAttribute("stroke-linecap","round"),a.appendChild(m)}},({color:f,point:u})=>{const m=document.createElement("circle"),p=typeof this.dotSize=="function"?this.dotSize():this.dotSize;m.setAttribute("r",p.toString()),m.setAttribute("cx",u.x.toString()),m.setAttribute("cy",u.y.toString()),m.setAttribute("fill",f),a.appendChild(m)});const c="data:image/svg+xml;base64,",d=`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="${s} ${i} ${o} ${h}" width="${o}" height="${h}">`;let l=a.innerHTML;if(l===void 0){const f=document.createElement("dummy"),u=a.childNodes;f.innerHTML="";for(let m=0;m<u.length;m+=1)f.appendChild(u[m].cloneNode(!0));l=f.innerHTML}const g="</svg>",_=d+l+g;return c+btoa(_)}}var B={format:"image/png",quality:.92,width:void 0,height:void 0,Canvas:void 0,crossOrigin:void 0},D=function(n,t){return n===void 0&&(n=[]),t===void 0&&(t={}),new Promise(function(e){t=Object.assign({},B,t);var s=t.Canvas?new t.Canvas:window.document.createElement("canvas"),i=t.Canvas?t.Canvas.Image:window.Image;t.Canvas&&(t.quality*=100);var o=n.map(function(a){return new Promise(function(c,d){a.constructor.name!=="Object"&&(a={src:a});var l=new i;l.crossOrigin=t.crossOrigin,l.onerror=function(){return d(new Error("Couldn't load image"))},l.onload=function(){return c(Object.assign({},a,{img:l}))},l.src=a.src})}),h=s.getContext("2d");e(Promise.all(o).then(function(a){var c=function(d){return t[d]||Math.max.apply(Math,a.map(function(l){return l.img[d]}))};return s.width=c("width"),s.height=c("height"),a.forEach(function(d){return h.globalAlpha=d.opacity?d.opacity:1,h.drawImage(d.img,d.x||0,d.y||0)}),t.Canvas&&t.format==="image/jpeg"?new Promise(function(d){s.toDataURL(t.format,{quality:t.quality,progressive:!1},function(l,g){if(l)throw l;d(g)})}):s.toDataURL(t.format,t.quality)}))})};const b=["image/png","image/jpeg","image/svg+xml"],N=n=>b.includes(n),$={dotSize:(.5+2.5)/2,minWidth:.5,maxWidth:2.5,throttle:16,minDistance:5,backgroundColor:"rgba(0,0,0,0)",penColor:"black",velocityFilterWeight:.7,onBegin:()=>{},onEnd:()=>{}},A=n=>JSON.parse(JSON.stringify(n)),k={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",x:0,y:0};var M=V({name:"VueSignaturePad",props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},customStyle:{type:Object,default:()=>({})},options:{type:Object,default:()=>({})},images:{type:Array,default:()=>[]},scaleToDevicePixelRatio:{type:Boolean,default:()=>!0}},data:()=>({signaturePad:{},cacheImages:[],signatureData:k,onResizeHandler:null}),computed:{propsImagesAndCustomImages(){const n=A(this.images),t=A(this.cacheImages);return[...n,...t]}},watch:{options:function(n){Object.keys(n).forEach(t=>{this.signaturePad[t]&&(this.signaturePad[t]=n[t])})}},mounted(){const{options:n}=this,t=this.$refs.signaturePadCanvas,e=new x(t,{...$,...n});this.signaturePad=e,n.resizeHandler&&(this.resizeCanvas=n.resizeHandler.bind(this)),this.onResizeHandler=this.resizeCanvas.bind(this),window.addEventListener("resize",this.onResizeHandler,!1),this.resizeCanvas()},beforeUnmount(){this.onResizeHandler&&window.removeEventListener("resize",this.onResizeHandler,!1)},methods:{resizeCanvas(){const n=this.$refs.signaturePadCanvas,t=this.signaturePad.toData(),e=this.scaleToDevicePixelRatio?Math.max(window.devicePixelRatio||1,1):1;n.width=n.offsetWidth*e,n.height=n.offsetHeight*e,n.getContext("2d").scale(e,e),this.signaturePad.clear(),this.signatureData=k,this.signaturePad.fromData(t)},saveSignature(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b[0],t=arguments.length>1?arguments[1]:void 0;const{signaturePad:e}=this,s={isEmpty:!1,data:void 0};if(!N(n)){const i=b.join(", ");throw new Error(`The Image type is incorrect! We are support ${i} types.`)}return e.isEmpty()?{...s,isEmpty:!0}:(this.signatureData=e.toDataURL(n,t),{...s,data:this.signatureData})},undoSignature(){const{signaturePad:n}=this,t=n.toData();if(t)return n.fromData(t.slice(0,-1))},mergeImageAndSignature(n){return this.signatureData=n,D([...this.images,...this.cacheImages,this.signatureData])},addImages(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return this.cacheImages=[...this.cacheImages,...n],D([...this.images,...this.cacheImages,this.signatureData])},fromDataURL(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;return this.signaturePad.fromDataURL(n,t,e)},fromData(n){return this.signaturePad.fromData(n)},toData(){return this.signaturePad.toData()},lockSignaturePad(){return this.signaturePad.off()},openSignaturePad(){return this.signaturePad.on()},isEmpty(){return this.signaturePad.isEmpty()},getPropImagesAndCacheImages(){return this.propsImagesAndCustomImages},clearCacheImages(){return this.cacheImages=[],this.cacheImages},clearSignature(){return this.signaturePad.clear()}},render(){const{width:n,height:t,customStyle:e}=this;return C("div",{style:{width:n,height:t,...e}},[C("canvas",{style:{width:n,height:t},ref:"signaturePadCanvas"})])}});M.__file="src/components/VueSignaturePad.vue";const F={class:"content"},O={class:"container-fluid",style:{"padding-bottom":"10px"}},H={class:"card card-primary"},j=r("div",{class:"card-header"}," Settings ",-1),q={class:"card-body bg-dark",id:"theContainer"},G={class:"card-body"},Y={class:"form-group row"},J=r("label",{for:"inputEmail3",class:"col-sm-3 col-form-label"},"Auto Generate Report",-1),X={class:"col-sm-9"},K={class:"form-check"},Q=r("label",{class:"form-check-label"},"None",-1),Z={class:"form-check"},tt=r("label",{class:"form-check-label"},"Hourly",-1),et={class:"form-check"},st=r("label",{class:"form-check-label"},"Daily",-1),it={class:"form-check"},nt=r("label",{class:"form-check-label"},"Monthly",-1),at={class:"form-check"},ot=r("label",{class:"form-check-label"},"Yearly",-1),rt={class:"form-group row"},ht=r("label",{for:"supervisor_name",class:"col-sm-3 col-form-label"},"Supervisor",-1),dt={class:"col-sm-9"},lt={class:"form-group row",style:{height:"30vh"}},ct=r("label",{for:"supervisorSign",class:"col-sm-3 col-form-label"},"Supervisor Signature",-1),ut={class:"col-sm-6"},mt={class:"col-sm-1"},gt=r("div",{class:"card-footer"},[r("button",{type:"submit",class:"btn btn-primary"},"Save")],-1),ft={data:()=>({dataValue:{},system_name:"",supervisor_name:"",supervisor_signature:null,supervisor_comment:"",smpt_server:null,smpt_port:"",auto_generate_report:"",location:"",options:{penColor:"#c0f"}}),async mounted(){await P().getSettings(),this.dataValue=await P().$state.data.settings.data,this.supervisor_signature=this.$refs.signaturePad.fromDataURL(this.dataValue.supervisor_signature)},methods:{async submitSetting(){const{isEmpty:n,data:t}=this.$refs.signaturePad.saveSignature();this.dataValue.supervisor_signature=t;const e={system_name:this.dataValue.system_name,supervisor_name:this.dataValue.supervisor_name,supervisor_signature:this.dataValue.supervisor_signature,supervisor_comment:this.dataValue.supervisor_comment,smpt_server:this.dataValue.smpt_server,smpt_port:this.dataValue.smpt_port,auto_generate_report:this.dataValue.auto_generate_report,location:this.dataValue.location};P().editSettings(e)},undo(){this.$refs.signaturePad.undoSignature()},reset(){this.$refs.signaturePad.clearSignature()}}},yt=Object.assign(ft,{__name:"index",setup(n){return(t,e)=>(I(),T("div",F,[r("div",O,[r("div",H,[j,r("form",{onSubmit:e[9]||(e[9]=U((...s)=>t.submitSetting&&t.submitSetting(...s),["prevent"])),method:"post"},[r("div",q,[r("div",G,[r("div",Y,[J,r("div",X,[r("div",K,[v(r("input",{class:"form-check-input",type:"radio",name:"radio1","onUpdate:modelValue":e[0]||(e[0]=s=>t.dataValue.auto_generate_report=s),value:"none"},null,512),[[y,t.dataValue.auto_generate_report]]),Q]),r("div",Z,[v(r("input",{class:"form-check-input",type:"radio",name:"radio1","onUpdate:modelValue":e[1]||(e[1]=s=>t.dataValue.auto_generate_report=s),value:"hourly"},null,512),[[y,t.dataValue.auto_generate_report]]),tt]),r("div",et,[v(r("input",{class:"form-check-input",type:"radio",name:"radio1","onUpdate:modelValue":e[2]||(e[2]=s=>t.dataValue.auto_generate_report=s),value:"daily"},null,512),[[y,t.dataValue.auto_generate_report]]),st]),r("div",it,[v(r("input",{class:"form-check-input",type:"radio",name:"radio1","onUpdate:modelValue":e[3]||(e[3]=s=>t.dataValue.auto_generate_report=s),value:"monthly"},null,512),[[y,t.dataValue.auto_generate_report]]),nt]),r("div",at,[v(r("input",{class:"form-check-input",type:"radio",name:"radio1","onUpdate:modelValue":e[4]||(e[4]=s=>t.dataValue.auto_generate_report=s),value:"yearly"},null,512),[[y,t.dataValue.auto_generate_report]]),ot])])]),r("div",rt,[ht,r("div",dt,[v(r("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>t.dataValue.supervisor_name=s),type:"text",class:"form-control",placeholder:"Supervisor Name"},null,512),[[L,t.dataValue.supervisor_name]])])]),r("div",lt,[ct,r("div",ut,[W(R(M),{ref:"signaturePad",id:"signature",modelValue:t.supervisor_signature,"onUpdate:modelValue":e[6]||(e[6]=s=>t.supervisor_signature=s)},null,8,["modelValue"])]),r("div",mt,[r("a",{onClick:e[7]||(e[7]=(...s)=>t.undo&&t.undo(...s)),class:"btn btn-secondary mb-2"},"Undo"),r("a",{onClick:e[8]||(e[8]=(...s)=>t.reset&&t.reset(...s)),class:"btn btn-secondary"},"Reset")])])])]),gt],32)])])]))}});export{yt as default};
