import{g as k,r as g,h as E,c as l,a as t,i as A,v as N,j as u,k as w,l as U,F as D,m as x,d as S,n as j,t as r,o as n,q as F}from"./entry.69edd33e.js";import{u as I}from"./fetch.761340c9.js";import{u as M}from"./data.8bfc3874.js";import{S as f}from"./sweetalert2.all.7ef268f0.js";const R={class:"content"},L={class:"container-fluid",style:{"padding-bottom":"10px"}},Y={class:"card card-primary"},q=t("div",{class:"card-header"},"Alarm History",-1),z={class:"card-body"},G={class:"row"},J={class:"col-md-12"},O={role:"group",class:"input-group mb-3 input-group-md"},W=t("div",{class:"input-group-prepend"},[t("div",{class:"input-group-text"},"Search...")],-1),X={class:"input-group-append"},K=["disabled"],Q={class:"card-body bg-dark",id:"theContainer"},Z={class:"table table-bordered"},tt={class:"bg-secondary"},et={class:"bg-dark-gray"},ot={key:0},st=t("th",null,"Room Id",-1),at=t("th",null,"Alarm Start",-1),lt=t("th",null,"Alarm End",-1),nt=t("th",null,"Duration",-1),rt=t("th",null,"Error",-1),it=t("th",null,"Alarm Type",-1),dt=t("th",null,"Values",-1),ct=t("th",null,"User Comment",-1),ut={key:0},pt=["onClick"],_t={key:1},vt={key:2},ht={key:3},mt={key:4},gt={class:"card-footer"},yt=["value"],ft={class:"pagination pagination-sm m-0 float-right"},bt={class:"page-item"},Ct={class:"page-item"},B=10,St={__name:"index",async setup(kt){let v,h;const p=M(),{data:b}=([v,h]=k(()=>I("/api/token","$wW2thL8nmk")),v=await v,h(),v);[v,h]=k(()=>p.getAlarmHistory()),await v,h();const a=g("");let s=g(1),m=g(0),_=g(0);m=p.$state.data.alarms.data.length;function P(d,o,e){return d.slice((e-1)*o,e*o)}const i=E(()=>{let d=p.$state.data.alarms.data,o=p.$state.data.alarms.data;return a.value!=""?(o=d.filter(e=>e.tagname.toUpperCase().includes(a.value.toUpperCase())||e.error.toUpperCase().includes(a.value.toUpperCase())||e.alarm_type.toUpperCase().includes(a.value.toUpperCase())||e.code.toUpperCase().includes(a.value.toUpperCase())||e.description.toUpperCase().includes(a.value.toUpperCase())),m=o.length,_=y(),s.value>_&&(s.value=1,C())):(o=d,m=o.length,_=y()),P(o,B,s.value)});_=y();function y(){return Math.ceil(m/B)}function T(){s.value<_&&s.value++}function $(){s.value>1&&s.value--}function C(){console.log("page :"+s.value)}async function H(d,o){f.fire({title:"Delete this data?",text:"Are you sure? You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",confirmButtonText:"Yes"}).then(e=>{e.isConfirmed&&p.deleteAlarm(d).then(c=>{V(d,o),f.fire({title:"Success",text:"Alarm History deleted successfully",icon:"success",timer:1500})}).catch(c=>{f.fire({title:"Error!",text:"Error delete data "+c,icon:"error"})}).finally(c=>{p.getAlarmHistory()})})}async function V(d,o){const e={tagname:i.value[o].tagname,alarm_start:i.value[o].alarm_start,duration:i.value[o].duration,error:i.value[o].error,alarm_type:i.value[o].alarm_type,description:i.value[o].description,code:i.value[o].code,values:i.value[o].values},c={access:"Alarm History",action:"Click Delete",description:"Delete Alarm History, Data : "+JSON.stringify(e).replaceAll('"',"").replaceAll("{","").replaceAll("}","")};p.postAuditTrail(c)}return(d,o)=>(n(),l("div",R,[t("div",L,[t("div",Y,[q,t("div",z,[t("div",G,[t("div",J,[t("div",O,[W,A(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=e=>w(a)?a.value=e:null)},null,512),[[N,u(a)]]),t("div",X,[t("button",{text:"Button",type:"button",class:"btn btn-secondary btn-md",disabled:!u(a),onClick:o[1]||(o[1]=e=>a.value="")}," X ",8,K)])])])])]),t("div",Q,[t("table",Z,[t("thead",tt,[t("tr",et,[u(b).role<=2?(n(),l("th",ot,"Action")):U("",!0),st,at,lt,nt,rt,it,dt,ct])]),t("tbody",null,[(n(!0),l(D,null,x(u(i),(e,c)=>(n(),l("tr",{key:c,class:F(e.code=="10"?"bg-danger":e.code=="00"?"bg-success":"bg-warning")},[u(b).role<=2?(n(),l("td",ut,[t("button",{class:"btn btn-default btn-sm",onClick:At=>H(e.id,c)}," Delete ",8,pt)])):U("",!0),t("td",null,r(e.roomid),1),t("td",null,r(e.alarm_start),1),e.alarm_end=="Invalid date"?(n(),l("td",_t)):(n(),l("td",vt,r(e.alarm_end),1)),e.alarm_end!="Invalid date"?(n(),l("td",ht,r(e.duration),1)):(n(),l("td",mt)),t("td",null,r(e.error),1),t("td",null,r(e.alarm_type),1),t("td",null,r(e.values),1),t("td",null,r(e.description),1)],2))),128))])])]),t("div",gt,[S(" Go To "),A(t("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>w(s)?s.value=e:s=e),onChange:o[3]||(o[3]=e=>C())},[(n(!0),l(D,null,x(u(_),e=>(n(),l("option",{value:e},r(e),9,yt))),256))],544),[[j,u(s)]]),S(" of "+r(u(_))+" ",1),t("ul",ft,[t("li",bt,[t("a",{class:"page-link text-white",href:"javascript:void(0);",onClick:o[4]||(o[4]=e=>$())},"Previous Page")]),t("li",Ct,[t("a",{class:"page-link text-white",href:"javascript:void(0);",onClick:o[5]||(o[5]=e=>T())},"Next Page")])])])])])]))}};export{St as default};
